from amaranth import *
from src.rom import *

###########################################
# rv32ui LW instruction tests:            #
###########################################

# Simulated ROM image:
lw_rom = rom_img( [
  0x6F004004, 0x732F2034, 0x930F8000, 0x6308FF03, 
  0x930F9000, 0x6304FF03, 0x930FB000, 0x6300FF03, 
  0x130F0000, 0x63040F00, 0x67000F00, 0x732F2034, 
  0x63540F00, 0x6F004000, 0x93E19153, 0x23203050, 
  0x6FF0DFFF, 0x732540F1, 0x63100500, 0x97020000, 
  0x93820201, 0x73905230, 0x73500018, 0x97020000, 
  0x9382C201, 0x73905230, 0x9302F0FF, 0x7390023B, 
  0x9302F001, 0x7390023A, 0x97020000, 0x93828201, 
  0x73905230, 0x73502030, 0x73503030, 0x73504030, 
  0x93010000, 0x97020000, 0x938202F7, 0x73905230, 
  0x13051000, 0x1315F501, 0x634A0500, 0x0F00F00F, 
  0x9308D005, 0x13050000, 0x6F004040, 0x93020000, 
  0x638E0200, 0x73905210, 0xB7B20000, 0x93829210, 
  0x73902230, 0x73232030, 0xE39062F6, 0x73500030, 
  0x37250000, 0x13050580, 0x73200530, 0x97020000, 
  0x93824201, 0x73901234, 0x732540F1, 0x73002030, 
  0x930F0000, 0x6314F03D, 0x97020020, 0x93828202, 
  0x970F0020, 0x938F8F00, 0x03A00F00, 0x23A00200, 
  0x93030000, 0x6314703A, 0x170F0020, 0x130F0FFF, 
  0x83200F00, 0x23A21200, 0xB7130DDD, 0x9383E3EE, 
  0x63967038, 0x970E0020, 0x938E4EFD, 0x03A10E00, 
  0x23A42200, 0xB7130DDD, 0x9383E3EE, 0x63187136, 
  0x170E0020, 0x130E8EFB, 0x8321CEFF, 0x23A63200, 
  0xB7D3BB0B, 0x9383C3C0, 0x639A7134, 0x970D0020, 
  0x938DCDF9, 0x03A20D00, 0x23A84200, 0xB7130DDD, 
  0x9383E3EE, 0x631C7232, 0x97000020, 0x9380C0FA, 
  0x170D0020, 0x130D8DF7, 0x83224D00, 0x23A05000, 
  0xB701FF0F, 0x9381010F, 0x639A3230, 0x970C0020, 
  0x938CCCF5, 0x03A30C00, 0x23A26000, 0xB7110DDD, 
  0x9381E1EE, 0x631C332E, 0x170C0020, 0x130C0CF4, 
  0x83230C00, 0x23A47000, 0xB7110DDD, 0x9381E1EE, 
  0x639E332C, 0x970B0020, 0x938B4BF2, 0x03A40B00, 
  0x23A68000, 0xB7110DDD, 0x9381E1EE, 0x6310342C, 
  0x170B0020, 0x130B8BF0, 0x83240B00, 0x23A89000, 
  0xB7110DDD, 0x9381E1EE, 0x6392342A, 0x97000020, 
  0x9380C0F2, 0x970A0020, 0x938A4AEE, 0x03A50A00, 
  0x23A0A000, 0x37140DDD, 0x1304E4EE, 0x63108528, 
  0x170A0020, 0x130A8AEC, 0x8325CAFF, 0x23A2B000, 
  0x37D4BB0B, 0x1304C4C0, 0x63928526, 0x97090020, 
  0x9389C9EA, 0x03A60900, 0x23A4C000, 0x37140DDD, 
  0x1304E4EE, 0x63148624, 0x17090020, 0x130909E9, 
  0x83264900, 0x23A6D000, 0x3704FF0F, 0x1304040F, 
  0x63968622, 0x97080020, 0x938848E7, 0x03A70800, 
  0x23A8E000, 0x37140DDD, 0x1304E4EE, 0x63188720, 
  0x17010020, 0x1301C1EA, 0x17080020, 0x130808E5, 
  0x83270800, 0x2320F100, 0x37120DDD, 0x1302E2EE, 
  0x6396471E, 0x97070020, 0x938747E3, 0x03A80700, 
  0x23220101, 0x37120DDD, 0x1302E2EE, 0x6318481C, 
  0x17070020, 0x130787E1, 0x83280700, 0x23241101, 
  0x37120DDD, 0x1302E2EE, 0x639A481A, 0x97060020, 
  0x9386C6DF, 0x03A90600, 0x23262101, 0x37120DDD, 
  0x1302E2EE, 0x631C4918, 0x17060020, 0x130606DE, 
  0x8329C6FF, 0x23283101, 0x37D2BB0B, 0x1302C2C0, 
  0x639E4916, 0x97000020, 0x9380C0E2, 0x97050020, 
  0x9385C5DB, 0x03AA0500, 0x23A04001, 0xB7110DDD, 
  0x9381E1EE, 0x631C3A14, 0x17050020, 0x130505DA, 
  0x832A4500, 0x23A25001, 0xB701FF0F, 0x9381010F, 
  0x639E3A12, 0x97040020, 0x938444D8, 0x03AB0400, 
  0x23A46001, 0xB7110DDD, 0x9381E1EE, 0x63103B12, 
  0x17040020, 0x130484D6, 0x832B0400, 0x23A67001, 
  0xB7110DDD, 0x9381E1EE, 0x63923B10, 0x97030020, 
  0x9383C3D4, 0x03AC0300, 0x23A88001, 0xB7110DDD, 
  0x9381E1EE, 0x63143C0E, 0x97000020, 0x9380C0DA, 
  0x17030020, 0x130383D2, 0x832C0300, 0x23A09001, 
  0x37140DDD, 0x1304E4EE, 0x63928C0C, 0x97020020, 
  0x9382C2D0, 0x03AD0200, 0x23A2A001, 0x37140DDD, 
  0x1304E4EE, 0x63148D0A, 0x17020020, 0x130202CF, 
  0x832DC2FF, 0x23A4B001, 0x37D4BB0B, 0x1304C4C0, 
  0x63968D08, 0x97010020, 0x938141CD, 0x03AE0100, 
  0x23A6C001, 0x37140DDD, 0x1304E4EE, 0x63188E06, 
  0x17010020, 0x130181CB, 0x832E4100, 0x23A8D001, 
  0x3704FF0F, 0x1304040F, 0x639A8E04, 0x17010020, 
  0x1301C1D2, 0x97000020, 0x938040C9, 0x03AF0000, 
  0x2320E101, 0x37120DDD, 0x1302E2EE, 0x63184F02, 
  0x97000020, 0x938080C7, 0x83AF0000, 0x2322F101, 
  0x37120DDD, 0x1302E2EE, 0x639A4F00, 0x0F00F00F, 
  0x9308D005, 0x13050000, 0x6FF05FFF, 0x0F00F00F, 
  0x9308D005, 0x37150000, 0x1305D5BA, 0x6FF01FFF, 
  0x731000C0, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000
] )

# Simulated initialized RAM image:
lw_ram = ram_img( [
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x22F2F111, 0xF44433F3, 0x66F6F555, 0xF88877F7, 
  0xAA0A0999, 0x0CCCBB0B, 0xEE0E0DDD, 0xF000FF0F, 
  0x78563412, 0xF0DEBC9A, 0x10325476, 0x98BADCFE, 
  0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 
  0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 
  0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 
  0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 
  0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 
  0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 
  0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 
  0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 
  0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x80000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000
] )

# Expected 'pass' register values.
lw_exp = {
  768: [ { 'r': 17, 'e': 93 }, { 'r': 10, 'e': 0 } ],  'end': 768
}

# Collected test program definition:
lw_test = [ 'LW compliance tests', 'cpu_lw', lw_rom, lw_ram, lw_exp ]