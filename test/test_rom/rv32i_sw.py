from amaranth import *
from src.rom import *

###########################################
# rv32ui SW instruction tests:            #
###########################################

# Simulated ROM image:
sw_rom = rom_img( [
  0x6F004004, 0x732F2034, 0x930F8000, 0x6308FF03, 
  0x930F9000, 0x6304FF03, 0x930FB000, 0x6300FF03, 
  0x130F0000, 0x63040F00, 0x67000F00, 0x732F2034, 
  0x63540F00, 0x6F004000, 0x93E19153, 0x23203060, 
  0x6FF0DFFF, 0x732540F1, 0x63100500, 0x97020000, 
  0x93820201, 0x73905230, 0x73500018, 0x97020000, 
  0x9382C201, 0x73905230, 0x9302F0FF, 0x7390023B, 
  0x9302F001, 0x7390023A, 0x97020000, 0x93828201, 
  0x73905230, 0x73502030, 0x73503030, 0x73504030, 
  0x93010000, 0x97020000, 0x938202F7, 0x73905230, 
  0x13051000, 0x1315F501, 0x634A0500, 0x0F00F00F, 
  0x9308D005, 0x13050000, 0x6F00804D, 0x93020000, 
  0x638E0200, 0x73905210, 0xB7B20000, 0x93829210, 
  0x73902230, 0x73232030, 0xE39062F6, 0x73500030, 
  0x37250000, 0x13050580, 0x73200530, 0x97020000, 
  0x93824201, 0x73901234, 0x732540F1, 0x73002030, 
  0x930F0000, 0x631EF049, 0x97020020, 0x938282FF, 
  0x23A00200, 0x1308F0FF, 0x938F0200, 0x938F0F7D, 
  0x23A80F83, 0x83A30200, 0x1303F0FF, 0x639A6346, 
  0x23A20200, 0x93071000, 0x138F4200, 0x130F0F00, 
  0x2320FF00, 0x83A34200, 0x13031000, 0x639A6344, 
  0x23A40200, 0x13070000, 0x938E8200, 0x938E1E00, 
  0xA3AFEEFE, 0x83A38200, 0x13030000, 0x639A6342, 
  0x23A60200, 0x9306F07F, 0x138EC200, 0x130E0E7D, 
  0x2328DE82, 0x83A3C200, 0x1303F07F, 0x639A6340, 
  0x23A80200, 0x13060000, 0x938D0201, 0x938D0D83, 
  0x23A8CD7C, 0x83A30201, 0x13030000, 0x639A633E, 
  0x97000020, 0x938040F6, 0x23A00000, 0xB7150000, 
  0x93850580, 0x138D0000, 0x130D0D83, 0x2328BD7C, 
  0x83A10000, 0x37110000, 0x13010180, 0x6392213C, 
  0x23A20000, 0x37456507, 0x13051532, 0x938C4000, 
  0x938C0C83, 0x23A8AC7C, 0x83A14000, 0x37416507, 
  0x13011132, 0x639E2138, 0x23A40000, 0xB7040080, 
  0x9384F4FF, 0x138C8000, 0x130CFCFF, 0xA3209C00, 
  0x83A18000, 0x37010080, 0x1301F1FF, 0x639A2136, 
  0x23A60000, 0x13041000, 0x938BC000, 0x938B0B83, 
  0x23A88B7C, 0x83A1C000, 0x13011000, 0x639A2134, 
  0x23A80000, 0x9303F0FF, 0x138B0001, 0x130B0B83, 
  0x23287B7C, 0x83A10001, 0x1301F0FF, 0x639A2132, 
  0x97000020, 0x938080EB, 0x23A00000, 0x37130000, 
  0x13034323, 0x938A0000, 0x938A0A83, 0x23A86A7C, 
  0x03A40000, 0xB7130000, 0x93834323, 0x63127430, 
  0x23A20000, 0xB7020080, 0x138A4000, 0x130A0A00, 
  0x23205A00, 0x03A44000, 0xB7030080, 0x6312742E, 
  0x23A40000, 0x37F2FFFF, 0x1302C2DC, 0x93898000, 
  0x93890983, 0x23A8497C, 0x03A48000, 0xB7F3FFFF, 
  0x9383C3DC, 0x631E742A, 0x23A60000, 0x9301F0FF, 
  0x1389C000, 0x13091900, 0xA32F39FE, 0x03A4C000, 
  0x9303F0FF, 0x631E7428, 0x23A80000, 0x13011080, 
  0x93880001, 0x93880800, 0x23A02800, 0x03A40001, 
  0x93031080, 0x631E7426, 0x17010020, 0x130141E1, 
  0x23200100, 0x9300E0FF, 0x13080100, 0x1308F8FF, 
  0xA3201800, 0x03220100, 0x9301E0FF, 0x631A3224, 
  0x23220100, 0x1300F0FF, 0x93074100, 0x9387077D, 
  0x23A80782, 0x03224100, 0x93010000, 0x631A3222, 
  0x23240100, 0x930F1000, 0x13078100, 0x13070700, 
  0x2320F701, 0x03228100, 0x93011000, 0x631A3220, 
  0x23260100, 0x130F0000, 0x9306C100, 0x93861600, 
  0xA3AFE6FF, 0x0322C100, 0x93010000, 0x631A321E, 
  0x23280100, 0x930EF07F, 0x13060101, 0x1306067D, 
  0x2328D683, 0x03220101, 0x9301F07F, 0x631A321C, 
  0x97000020, 0x938000D8, 0x23A00000, 0x130E0000, 
  0x93850000, 0x93850583, 0x23A8C57D, 0x83A10000, 
  0x13010000, 0x6396211A, 0x23A20000, 0xB71D0000, 
  0x938D0D80, 0x13854000, 0x13050583, 0x2328B57D, 
  0x83A14000, 0x37110000, 0x13010180, 0x63922118, 
  0x23A40000, 0x374D6507, 0x130D1D32, 0x93848000, 
  0x93840483, 0x23A8A47D, 0x83A18000, 0x37416507, 
  0x13011132, 0x639E2114, 0x23A60000, 0xB70C0080, 
  0x938CFCFF, 0x1384C000, 0x1304F4FF, 0xA3209401, 
  0x83A1C000, 0x37010080, 0x1301F1FF, 0x639A2112, 
  0x23A80000, 0x130C1000, 0x93830001, 0x93830383, 
  0x23A8837D, 0x83A10001, 0x13011000, 0x639A2110, 
  0x97000020, 0x938040CD, 0x23A00000, 0x930BF0FF, 
  0x13830000, 0x13030383, 0x2328737D, 0x03A40000, 
  0x9303F0FF, 0x6316740E, 0x23A20000, 0x371B0000, 
  0x130B4B23, 0x93824000, 0x93820283, 0x23A8627D, 
  0x03A44000, 0xB7130000, 0x93834323, 0x6312740C, 
  0x23A40000, 0xB70A0080, 0x13828000, 0x13020200, 
  0x23205201, 0x03A48000, 0xB7030080, 0x6312740A, 
  0x23A60000, 0x37FAFFFF, 0x130ACADC, 0x9381C000, 
  0x93810183, 0x23A8417D, 0x03A4C000, 0xB7F3FFFF, 
  0x9383C3DC, 0x631E7406, 0x23A80000, 0x9309F0FF, 
  0x13810001, 0x13011100, 0xA32F31FF, 0x03A40001, 
  0x9303F0FF, 0x631E7404, 0x17010020, 0x130101C3, 
  0x23200100, 0x13091080, 0x93000100, 0x93800000, 
  0x23A02001, 0x03220100, 0x93011080, 0x631A3202, 
  0x23220100, 0x9308E0FF, 0x93004100, 0x9380F0FF, 
  0xA3A01001, 0x03224100, 0x9301E0FF, 0x631A3200, 
  0x0F00F00F, 0x9308D005, 0x13050000, 0x6FF05FFF, 
  0x0F00F00F, 0x9308D005, 0x37150000, 0x1305D5BA, 
  0x6FF01FFF, 0x731000C0, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000
] )

# Simulated initialized RAM image:
sw_ram = ram_img( [
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 
  0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 
  0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 
  0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 
  0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 
  0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 
  0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 
  0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 
  0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x80000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000
] )

# Expected 'pass' register values.
sw_exp = {
  896: [ { 'r': 17, 'e': 93 }, { 'r': 10, 'e': 0 } ],  'end': 896
}

# Collected test program definition:
sw_test = [ 'SW compliance tests', 'cpu_sw', sw_rom, sw_ram, sw_exp ]