from amaranth import *
from src.rom import *

###########################################
# rv32ui SLLI instruction tests:          #
###########################################

# Simulated ROM image:
slli_rom = rom_img( [
  0x6F004004, 0x732F2034, 0x930F8000, 0x6308FF03, 
  0x930F9000, 0x6304FF03, 0x930FB000, 0x6300FF03, 
  0x130F0000, 0x63040F00, 0x67000F00, 0x732F2034, 
  0x63540F00, 0x6F004000, 0x93E19153, 0x23203050, 
  0x6FF0DFFF, 0x732540F1, 0x63100500, 0x97020000, 
  0x93820201, 0x73905230, 0x73500018, 0x97020000, 
  0x9382C201, 0x73905230, 0x9302F0FF, 0x7390023B, 
  0x9302F001, 0x7390023A, 0x97020000, 0x93828201, 
  0x73905230, 0x73502030, 0x73503030, 0x73504030, 
  0x93010000, 0x97020000, 0x938202F7, 0x73905230, 
  0x13051000, 0x1315F501, 0x634A0500, 0x0F00F00F, 
  0x9308D005, 0x13050000, 0x6F008034, 0x93020000, 
  0x638E0200, 0x73905210, 0xB7B20000, 0x93829210, 
  0x73902230, 0x73232030, 0xE39062F6, 0x73500030, 
  0x37250000, 0x13050580, 0x73200530, 0x97020000, 
  0x93824201, 0x73901234, 0x732540F1, 0x73002030, 
  0x930F0000, 0x6316F031, 0x97020020, 0x938282FF, 
  0x930FF0FF, 0x13900F00, 0x23A00200, 0x13030000, 
  0x6318602E, 0x130F1000, 0x93100F00, 0x23A21200, 
  0x13031000, 0x639E602C, 0x930E0000, 0x13911E00, 
  0x23A42200, 0x13030000, 0x6314612C, 0x130EF07F, 
  0x93114E00, 0x23A63200, 0x37830000, 0x130303FF, 
  0x6398612A, 0x930D0000, 0x13928D00, 0x23A84200, 
  0x13030000, 0x631E6228, 0x97000020, 0x9380C0F9, 
  0x371D0000, 0x130D0D80, 0x9312FD01, 0x23A05000, 
  0x13010000, 0x639E2226, 0xB74C6507, 0x938C1C32, 
  0x13930C01, 0x23A26000, 0x37012143, 0x63122326, 
  0x370C0080, 0x130CFCFF, 0x93131C00, 0x23A47000, 
  0x1301E0FF, 0x63962324, 0x930B1000, 0x13940B00, 
  0x23A68000, 0x13011000, 0x631C2422, 0x130BF0FF, 
  0x93140B00, 0x23A89000, 0x1301F0FF, 0x63922422, 
  0x97000020, 0x938080F3, 0xB71A0000, 0x938A4A23, 
  0x13951A00, 0x23A0A000, 0xB7230000, 0x93838346, 
  0x63107520, 0x370A0080, 0x93154A00, 0x23A2B000, 
  0x93030000, 0x6396751E, 0xB7F9FFFF, 0x9389C9DC, 
  0x13968900, 0x23A4C000, 0xB7D3EDFF, 0x938303C0, 
  0x6318761C, 0x1309F0FF, 0x9316F901, 0x23A6D000, 
  0xB7030080, 0x639E761A, 0x93081080, 0x13970801, 
  0x23A8E000, 0xB70301F8, 0x6314771A, 0x17010020, 
  0x130101ED, 0x13080000, 0x93171800, 0x2320F100, 
  0x93010000, 0x63963718, 0x9307F0FF, 0x13980700, 
  0x23220101, 0x9301F0FF, 0x631C3816, 0x13071000, 
  0x93180700, 0x23241101, 0x93011000, 0x63923816, 
  0x93060000, 0x13991600, 0x23262101, 0x93010000, 
  0x63183914, 0x1306F07F, 0x93194600, 0x23283101, 
  0xB7810000, 0x938101FF, 0x639C3912, 0x97000020, 
  0x938040E7, 0x93050000, 0x139A8500, 0x23A04001, 
  0x13010000, 0x631E2A10, 0x37150000, 0x13050580, 
  0x931AF501, 0x23A25001, 0x13010000, 0x63922A10, 
  0xB7446507, 0x93841432, 0x139B0401, 0x23A46001, 
  0x37012143, 0x63162B0E, 0x37040080, 0x1304F4FF, 
  0x931B1400, 0x23A67001, 0x1301E0FF, 0x639A2B0C, 
  0x93031000, 0x139C0300, 0x23A88001, 0x13011000, 
  0x63102C0C, 0x97000020, 0x938000E1, 0x1303F0FF, 
  0x931C0300, 0x23A09001, 0x9303F0FF, 0x63927C0A, 
  0xB7120000, 0x93824223, 0x139D1200, 0x23A2A001, 
  0xB7230000, 0x93838346, 0x63147D08, 0x37020080, 
  0x931D4200, 0x23A4B001, 0x93030000, 0x639A7D06, 
  0xB7F1FFFF, 0x9381C1DC, 0x139E8100, 0x23A6C001, 
  0xB7D3EDFF, 0x938303C0, 0x631C7E04, 0x1301F0FF, 
  0x931EF101, 0x23A8D001, 0xB7030080, 0x63927E04, 
  0x17010020, 0x130181DA, 0x93001080, 0x139F0001, 
  0x2320E101, 0xB70101F8, 0x63143F02, 0x13000000, 
  0x931F1000, 0x2322F101, 0x93010000, 0x639A3F00, 
  0x0F00F00F, 0x9308D005, 0x13050000, 0x6FF05FFF, 
  0x0F00F00F, 0x9308D005, 0x37150000, 0x1305D5BA, 
  0x6FF01FFF, 0x731000C0, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000
] )

# Simulated initialized RAM image:
slli_ram = ram_img( [
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 
  0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 
  0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 
  0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 
  0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 
  0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 
  0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 
  0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 
  0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x80000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000
] )

# Expected 'pass' register values.
slli_exp = {
  768: [ { 'r': 17, 'e': 93 }, { 'r': 10, 'e': 0 } ],  'end': 768
}

# Collected test program definition:
slli_test = [ 'SLLI compliance tests', 'cpu_slli', slli_rom, slli_ram, slli_exp ]