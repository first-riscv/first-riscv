from amaranth import *
from src.rom import *

###########################################
# rv32ui LH instruction tests:            #
###########################################

# Simulated ROM image:
lh_rom = rom_img( [
  0x6F004004, 0x732F2034, 0x930F8000, 0x6308FF03, 
  0x930F9000, 0x6304FF03, 0x930FB000, 0x6300FF03, 
  0x130F0000, 0x63040F00, 0x67000F00, 0x732F2034, 
  0x63540F00, 0x6F004000, 0x93E19153, 0x23203050, 
  0x6FF0DFFF, 0x732540F1, 0x63100500, 0x97020000, 
  0x93820201, 0x73905230, 0x73500018, 0x97020000, 
  0x9382C201, 0x73905230, 0x9302F0FF, 0x7390023B, 
  0x9302F001, 0x7390023A, 0x97020000, 0x93828201, 
  0x73905230, 0x73502030, 0x73503030, 0x73504030, 
  0x93010000, 0x97020000, 0x938202F7, 0x73905230, 
  0x13051000, 0x1315F501, 0x634A0500, 0x0F00F00F, 
  0x9308D005, 0x13050000, 0x6F00403F, 0x93020000, 
  0x638E0200, 0x73905210, 0xB7B20000, 0x93829210, 
  0x73902230, 0x73232030, 0xE39062F6, 0x73500030, 
  0x37250000, 0x13050580, 0x73200530, 0x97020000, 
  0x93824201, 0x73901234, 0x732540F1, 0x73002030, 
  0x930F0000, 0x631CF03B, 0x97020020, 0x93828202, 
  0x970F0020, 0x938F8F00, 0x03900F00, 0x23A00200, 
  0x93030000, 0x631C7038, 0x170F0020, 0x130F0FFF, 
  0x8310EFFF, 0x23A21200, 0xB7130000, 0x9383B3BB, 
  0x639E7036, 0x970E0020, 0x938E4EFD, 0x03912E00, 
  0x23A42200, 0xB7E3FFFF, 0x9383D3D0, 0x63107136, 
  0x170E0020, 0x130E8EFB, 0x8311CEFF, 0x23A63200, 
  0xB7D3FFFF, 0x9383C3C0, 0x63927134, 0x970D0020, 
  0x938DCDF9, 0x03922D00, 0x23A84200, 0xB7E3FFFF, 
  0x9383D3D0, 0x63147232, 0x97000020, 0x9380C0FA, 
  0x170D0020, 0x130D8DF7, 0x83124D00, 0x23A05000, 
  0x9301000F, 0x63943230, 0x970C0020, 0x938C0CF6, 
  0x03930C00, 0x23A26000, 0xB7110000, 0x9381E1EE, 
  0x6316332E, 0x170C0020, 0x130C4CF4, 0x83130C00, 
  0x23A47000, 0xB7110000, 0x9381E1EE, 0x6398332C, 
  0x970B0020, 0x938B8BF2, 0x03940B00, 0x23A68000, 
  0xB7110000, 0x9381E1EE, 0x631A342A, 0x170B0020, 
  0x130BCBF0, 0x8314EBFF, 0x23A89000, 0xB7110000, 
  0x9381B1BB, 0x639C3428, 0x97000020, 0x938000F3, 
  0x970A0020, 0x938A8AEE, 0x03952A00, 0x23A0A000, 
  0x37E4FFFF, 0x1304D4D0, 0x631A8526, 0x170A0020, 
  0x130ACAEC, 0x8315CAFF, 0x23A2B000, 0x37D4FFFF, 
  0x1304C4C0, 0x639C8524, 0x97090020, 0x938909EB, 
  0x03962900, 0x23A4C000, 0x37E4FFFF, 0x1304D4D0, 
  0x631E8622, 0x17090020, 0x130949E9, 0x83164900, 
  0x23A6D000, 0x1304000F, 0x63928622, 0x97080020, 
  0x9388C8E7, 0x03970800, 0x23A8E000, 0x37140000, 
  0x1304E4EE, 0x63148720, 0x17010020, 0x130141EB, 
  0x17080020, 0x130888E5, 0x83170800, 0x2320F100, 
  0x37120000, 0x1302E2EE, 0x6392471E, 0x97070020, 
  0x9387C7E3, 0x03980700, 0x23220101, 0x37120000, 
  0x1302E2EE, 0x6314481C, 0x17070020, 0x130707E2, 
  0x8318E7FF, 0x23241101, 0x37120000, 0x1302B2BB, 
  0x6396481A, 0x97060020, 0x938646E0, 0x03992600, 
  0x23262101, 0x37E2FFFF, 0x1302D2D0, 0x63184918, 
  0x17060020, 0x130686DE, 0x8319C6FF, 0x23283101, 
  0x37D2FFFF, 0x1302C2C0, 0x639A4916, 0x97000020, 
  0x938040E3, 0x97050020, 0x938545DC, 0x039A2500, 
  0x23A04001, 0xB7E1FFFF, 0x9381D1D0, 0x63183A14, 
  0x17050020, 0x130585DA, 0x831A4500, 0x23A25001, 
  0x9301000F, 0x639C3A12, 0x97040020, 0x938404D9, 
  0x039B0400, 0x23A46001, 0xB7110000, 0x9381E1EE, 
  0x631E3B10, 0x17040020, 0x130444D7, 0x831B0400, 
  0x23A67001, 0xB7110000, 0x9381E1EE, 0x63903B10, 
  0x97030020, 0x938383D5, 0x039C0300, 0x23A88001, 
  0xB7110000, 0x9381E1EE, 0x63123C0E, 0x97000020, 
  0x938080DB, 0x17030020, 0x130343D3, 0x831CE3FF, 
  0x23A09001, 0x37140000, 0x1304B4BB, 0x63908C0C, 
  0x97020020, 0x938282D1, 0x039D2200, 0x23A2A001, 
  0x37E4FFFF, 0x1304D4D0, 0x63128D0A, 0x17020020, 
  0x1302C2CF, 0x831DC2FF, 0x23A4B001, 0x37D4FFFF, 
  0x1304C4C0, 0x63948D08, 0x97010020, 0x938101CE, 
  0x039E2100, 0x23A6C001, 0x37E4FFFF, 0x1304D4D0, 
  0x63168E06, 0x17010020, 0x130141CC, 0x831E4100, 
  0x23A8D001, 0x1304000F, 0x639A8E04, 0x17010020, 
  0x1301C1D3, 0x97000020, 0x938040CA, 0x039F0000, 
  0x2320E101, 0x37120000, 0x1302E2EE, 0x63184F02, 
  0x97000020, 0x938080C8, 0x839F0000, 0x2322F101, 
  0x37120000, 0x1302E2EE, 0x639A4F00, 0x0F00F00F, 
  0x9308D005, 0x13050000, 0x6FF05FFF, 0x0F00F00F, 
  0x9308D005, 0x37150000, 0x1305D5BA, 0x6FF01FFF, 
  0x731000C0, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000
] )

# Simulated initialized RAM image:
lh_ram = ram_img( [
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x22F2F111, 0xF44433F3, 0x66F6F555, 0xF88877F7, 
  0xAA0A0999, 0x0CCCBB0B, 0xEE0E0DDD, 0xF000FF0F, 
  0x78563412, 0xF0DEBC9A, 0x10325476, 0x98BADCFE, 
  0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 
  0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 
  0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 
  0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 
  0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 
  0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 
  0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 
  0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 
  0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x80000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000, 
  0x00000000, 0x00000000, 0x00000000, 0x00000000
] )

# Expected 'pass' register values.
lh_exp = {
  768: [ { 'r': 17, 'e': 93 }, { 'r': 10, 'e': 0 } ],  'end': 768
}

# Collected test program definition:
lh_test = [ 'LH compliance tests', 'cpu_lh', lh_rom, lh_ram, lh_exp ]